{
  "version": 3,
  "sources": ["../src/xz-notify.js"],
  "sourcesContent": ["/**\n * TODO write doc\n * attributes:\n * type\n * expire\n * closeable\n * position\n*/\nexport default class XZNotify extends HTMLElement {\n  /**\n   * XZNofity HTML tag name.\n   * @type {string}\n   */\n  static TAG_NAME = 'xz-notify';\n\n  /**\n   * Observed attributes if required. usually notication's life is very short\n   * and no point to observe attributes.\n   * @type {Array<string>}\n   */\n  static observedAttributes = [];\n\n  /**\n   * Notification's possible types.\n   * @type {{\n   *  DEFAULT: string,\n   *  INFO: string,\n   *  WARNING: string,\n   *  SUCCESS: string,\n   *  ERROR: string,\n   * }}\n   */\n  static types = {\n    DEFAULT: 'default',\n    INFO:    'info',\n    WARNING: 'warning',\n    SUCCESS: 'success',\n    ERROR:   'error',\n  };\n\n  /**\n   * Events for the component.\n   * @type {{OPEN: CustomEvent, CLOSE: CustomEvent}}\n   */\n  static events = {\n    OPEN:  new CustomEvent('xz-notify:open', {bubbles: true}),\n    CLOSE: new CustomEvent('xz-notify:close', {bubbles: true}),\n  };\n\n  /**\n   * Positioning constants.\n   * @type {Object<string, string>}\n   */\n  static position = {\n    N:  'n',\n    NE: 'ne',\n    E:  'e',\n    SE: 'se',\n    S:  's',\n    SW: 'sw',\n    W:  'w',\n    NW: 'nw',\n  };\n\n  /**\n   * Contains currently opened notifications.\n   * @type {Object<string, Array<XZNotify>}\n   */\n  static collection = {\n    [this.position.N]:  [],\n    [this.position.NE]: [],\n    [this.position.E]:  [],\n    [this.position.SE]: [],\n    [this.position.S]:  [],\n    [this.position.SW]: [],\n    [this.position.W]:  [],\n    [this.position.NW]: [],\n  };\n\n  /**\n   * Defaults for the component.\n   * @type {Object<string, string>}\n   */\n  static defaults = {\n    EXPIRE:    5000,\n    TYPE:      this.types.DEFAULT,\n    POSITION:  this.position.NE,\n    CLOSEABLE: false,\n  };\n\n  /**\n   * Creates a new XZNotify element. Recommended to use when creating\n   * notifications.\n   * @param {string} content\n   * @param {Object<string, string>} attrs\n   * @param {boolean} trusted\n   * @return {XZNotify}\n   */\n  static create = (content, attrs = {}, trusted = false) => {\n    const elem = document.createElement(this.TAG_NAME);\n    Object.entries(attrs).forEach(([k, v]) => elem.setAttribute(k, v));\n\n    if (!trusted) {\n      elem.innerText = content;\n    } else {\n      elem.innerHTML = content;\n    }\n    return elem;\n  };\n\n  // Private vars here please...\n  #styleElem = document.createElement('style');\n  #forcedClose = false;\n  #css = `\n    :host {\n      display:        var(--xz-notify-display, block);\n      border-radius:  var(--xz-notify-border-radius, .375em);\n      border-width:   var(--xz-notify-border-width, .0625em);\n      border-style:   var(--xz-notify-border-style, solid);\n      font-family:    var(--xz-notify-font-family,\\\n        system-ui, -apple-system, Arial, sans-serif);\n      font-size:      var(--xz-notify-font-size, 16px);\n      font-weight:    var(--xz-notify-font-weight, normal);\n      line-height:    var(--xz-notify-line-height, normal);\n      margin:         var(--xz-notify-margin, .5em);\n      padding:        var(--xz-notify-padding, 1em);\n      width:          var(--xz-notify-width, fit-content);\n      max-width:      var(--xz-notify-max-width, 28em);\n      min-width:      var(--xz-notify-min-width, 18em);\n      height:         var(--xz-notify-height, auto);\n      opacity:        var(--xz-notify-opacity, 1);\n      position:       var(--zx-notify-position, fixed);\n      left:           var(--xz-notify-left);\n      top:            var(--xz-notify-top);\n      z-index:        var(--xz-notify-z-index, auto);\n      animation:      var(--xz-notify-animation, xz-close .25s ease-in 1);\n      animation-play-state: paused;\n\n      background:    var(--xz-notify-default-background, #fcfcfd);\n      border-color:  var(--xz-notify-default-border-color, #e9ecef);\n      color:         var(--xz-notify-default-color, #495057);\n    }\n\n    :host([type=\"${this.constructor.types.SUCCESS}\"]) {\n      background:    var(--xz-notify-default-background, #d1e7dd);\n      border-color:  var(--xz-notify-default-border-color, #a3cfbb);\n      color:         var(--xz-notify-default-color, #0a3922);\n    }\n    :host([type=\"${this.constructor.types.INFO}\"]) {\n      background:    var(--xz-notify-default-background, #cfe2ff);\n      border-color:  var(--xz-notify-default-border-color, #9ec5fe);\n      color:         var(--xz-notify-default-color, #052c65);\n    }\n    :host([type=\"${this.constructor.types.WARNING}\"]) {\n      background:    var(--xz-notify-default-background, #fff3cd);\n      border-color:  var(--xz-notify-default-border-color, #ffe69c);\n      color:         var(--xz-notify-default-color, #664d03);\n    }\n    :host([type=\"${this.constructor.types.ERROR}\"]) {\n      background:    var(--xz-notify-default-background, #f8d7da);\n      border-color:  var(--xz-notify-default-border-color, #f1aeb5);\n      color:         var(--xz-notify-default-color, #58151c);\n    }\n\n    :host([closeable]) {\n      cursor: pointer;\n    }\n    :host([closeable]:hover) {\n      filter: brightness(.975);\n    }\n    :host p {margin-top: 0}\n    :host a {color: currentColor}\n\n    @keyframes xz-close {to {opacity: 0}}\n    @media (prefers-reduced-motion) {\n      :host {\n        animation-duration: 1ms;\n      }\n    }`;\n  // #slot = document.createElement('slot'); // TODO remove?\n\n  /**\n   * Construction function is called before instance of notification is created.\n   * @constructor\n   */\n  constructor() {\n    super();\n    this.root = this.attachShadow({mode: 'open'});\n    this.css = this.#css;\n  }\n\n  /**\n   * @type {string}\n   */\n  get css() {\n    return this.#css;\n  }\n\n  /**\n   * @param {string} v\n   */\n  set css(v) {\n    this.#css = v;\n    this.#styleElem.textContent = this.#css;\n  }\n\n  /**\n   * Calculates and sets the position of the notification.\n   */\n  #setPosition() {\n    const i = this.constructor.collection[this.position]\n        .findIndex((x) => x === this);\n    const rect = this.getBoundingClientRect();\n    const styles = getComputedStyle(this);\n    const mt = parseInt(styles.getPropertyValue('margin-top'));\n    const mr = parseInt(styles.getPropertyValue('margin-right'));\n    const mb = parseInt(styles.getPropertyValue('margin-bottom'));\n    const ml = parseInt(styles.getPropertyValue('margin-left'));\n    let x, y, dx, dy;\n    switch (this.position) {\n      case XZNotify.position.N:\n        [x, y] = ['50%', '0%'];\n        [dx, dy] = [rect.width/2, i*(rect.height + mt)];\n        break;\n      case XZNotify.position.NE:\n        [x, y] = ['100%', '0%'];\n        [dx, dy] = [rect.width + ml + mr, i*(rect.height + mt)];\n        break;\n      case XZNotify.position.E:\n        [x, y] = ['100%', '50%'];\n        [dx, dy] = [(i+1)*(rect.width + ml + mr), -(rect.height/2 + mt + mb)];\n        break;\n      case XZNotify.position.SE:\n        [x, y] = ['100%', '100%'];\n        [dx, dy] = [rect.width + ml + mr, -(i+1)*(rect.height + mt + mb)];\n        break;\n      case XZNotify.position.S:\n        [x, y] = ['50%', '100%'];\n        [dx, dy] = [rect.width/2, -(i+1)*(rect.height + mt + mb)];\n        break;\n      case XZNotify.position.SW:\n        [x, y] = ['0%', '100%'];\n        [dx, dy] = [0, -(i+1)*(rect.height + mt + mb)];\n        break;\n      case XZNotify.position.W:\n        [x, y] = ['0%', '50%'];\n        [dx, dy] = [i*-(rect.width + ml), -(rect.height/2 + mt + mb)];\n        break;\n      case XZNotify.position.NW:\n        [x, y] = ['0%', '0%'];\n        [dx, dy] = [0, i*(rect.height + mt)];\n        break;\n    };\n    this.style.setProperty('--xz-notify-left', `calc(${x} - ${dx}px)`);\n    this.style.setProperty('--xz-notify-top', `calc(${y} + ${dy}px)`);\n  }\n\n  /**\n   * Re-position all elements.\n   */\n  #setPositionAll() {\n    Object.values(this.constructor.collection).forEach((coll) => {\n      coll.forEach((x) => this.#setPosition.call(x));\n    });\n  }\n\n  /**\n   * @inheritdoc\n   */\n  connectedCallback() {\n    this.#reflectToProperites();\n    this.constructor.collection[this.position].push(this);\n    this.dispatchEvent(this.constructor.events.OPEN, this);\n    this.#render();\n    this.#hydrate();\n  }\n\n  /**\n   * Reflect attributes to properties for convineicen.\n   * Use default if no attribute set.\n   */\n  #reflectToProperites() {\n    this.type = (this.getAttribute('type')\n        || this.constructor.defaults.TYPE).toLowerCase();\n    this.position = (this.getAttribute('position')\n        || this.constructor.position.NE).toLowerCase();\n    this.expire = Number(this.getAttribute('expire'))\n        || this.constructor.defaults.EXPIRE;\n    this.closeable = this.hasAttribute('closeable');\n  }\n\n  /**\n   * Renders element.\n   * @private\n   */\n  #render() {\n    // TODO try to think out better solution, maybe slots?\n    this.root.append(this.#styleElem, ...this.childNodes);\n  }\n\n  /**\n   * Added all interactivity here for potential SSR.\n   * But actually can be done in render() or connectedCallback().\n   * @private\n   */\n  #hydrate() {\n    this.#setPosition();\n    let start;\n    const tick = (ts) => {\n      if (start === undefined) {\n        start = ts;\n      }\n      if (ts - start >= this.expire || this.#forcedClose) {\n        this.dataset.closing= '';\n        this.style.animationPlayState = 'running';\n        return;\n      }\n      requestAnimationFrame(tick);\n    };\n    requestAnimationFrame(tick);\n    this.addEventListener('animationend', this.remove);\n    if (this.closeable) {\n      this.addEventListener('click', this.closeHandler.bind(this));\n    }\n  }\n\n  /**\n   * Handler when closeable is true and clicked on the nofication.\n   * @param {MouseEvent|PointerEvent} e\n   */\n  closeHandler(e) {\n    this.#forcedClose = true;\n  }\n\n  /**\n   * @inheritdoc\n   */\n  disconnectedCallback() {\n    this.dispatchEvent(this.constructor.events.CLOSE, this);\n    this.constructor.collection[this.position]\n        = this.constructor.collection[this.position].filter((x) => x !== this);\n    this.#setPositionAll();\n  }\n}\n"],
  "mappings": "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",
  "names": ["XZNotify", "content", "attrs", "trusted", "elem", "k", "v", "#styleElem", "#forcedClose", "#css", "#setPosition", "i", "x", "rect", "styles", "mt", "mr", "mb", "ml", "y", "dx", "dy", "#setPositionAll", "coll", "#reflectToProperites", "#render", "#hydrate", "start", "tick", "ts", "e"]
}
